@model IEnumerable<ManagingAgriculture.Models.Resource>
@{
    ViewData["Title"] = "Resource Management";
    var selectedCategory = ViewBag.SelectedCategory;
}

<div class="resources-container">
    <div class="resources-header">
        <div>
            <p class="subtitle">Track your farm inventory and supplies</p>
        </div>
    </div>

    <!-- Category Tabs -->
    <div class="category-tabs">
        <a href="@Url.Action("Index", "Resources", new { category = "all" })" class="tab-btn @(selectedCategory == "all" ? "active" : "")">All</a>
        <a href="@Url.Action("Index", "Resources", new { category = "Fertilizer" })" class="tab-btn @(selectedCategory == "Fertilizer" ? "active" : "")">Fertilizer</a>
        <a href="@Url.Action("Index", "Resources", new { category = "Seed" })" class="tab-btn @(selectedCategory == "Seed" ? "active" : "")">Seed</a>
        <a href="@Url.Action("Index", "Resources", new { category = "Chemical" })" class="tab-btn @(selectedCategory == "Chemical" ? "active" : "")">Chemical</a>
        <a href="@Url.Action("Index", "Resources", new { category = "Water" })" class="tab-btn @(selectedCategory == "Water" ? "active" : "")">Water</a>
        <a href="@Url.Action("Index", "Resources", new { category = "Fuel" })" class="tab-btn @(selectedCategory == "Fuel" ? "active" : "")">Fuel</a>
    </div>

    <!-- Resources Grid -->
    <div class="resources-grid">
        @foreach (var resource in Model)
        {
            <!-- Determine stock status -->
            string stockStatus = resource.Quantity < resource.LowStockThreshold ? "low-stock" : "in-stock";
            string stockStatusText = resource.Quantity < resource.LowStockThreshold ? "Low Stock" : "In Stock";

            <div class="resource-card">
                <div class="resource-header">
                    <div class="resource-title">
                        @{
                            string iconClass = resource.Category switch
                            {
                                "Fertilizer" => "fa-leaf",
                                "Seed" => "fa-seedling",
                                "Chemical" => "fa-spray-can",
                                "Water" => "fa-droplet",
                                "Fuel" => "fa-gas-pump",
                                _ => "fa-box"
                            };
                        }
                        <i class="fas @iconClass resource-icon"></i>
                        <div>
                            <h3>@resource.Name</h3>
                            <span class="resource-category">@resource.Category</span>
                        </div>
                    </div>
                    <span class="status-badge @stockStatus">@stockStatusText</span>
                </div>

                <div class="resource-amount">
                    <span class="amount-number">@resource.Quantity</span>
                    <span class="amount-unit">@resource.Unit</span>
                </div>

                <div class="stock-info">
                    <span class="low-stock-label">Low stock at</span>
                    <span class="low-stock-value">@resource.LowStockThreshold @resource.Unit</span>
                </div>

                @if (!string.IsNullOrEmpty(resource.Supplier))
                {
                    <div class="supplier-info">
                        <span class="supplier-label">Supplier</span>
                        <span class="supplier-name">@resource.Supplier</span>
                    </div>
                }

                @if (resource.Quantity < resource.LowStockThreshold)
                {
                    <div class="alert-box">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Restock needed soon</span>
                    </div>
                }
                <div class="mt-3 d-flex gap-2 action-row">
                    <a class="btn btn-sm btn-outline-primary action-btn" href="@Url.Action("Edit","Resources", new { id = resource.Id })"><i class="fas fa-edit"></i> Edit</a>
                    <button class="btn btn-sm btn-success action-btn adjust-ajax" data-id="@resource.Id" data-delta="10"><i class="fas fa-plus"></i> + Add 10</button>
                    <button class="btn btn-sm btn-danger action-btn adjust-ajax" data-id="@resource.Id" data-delta="-10"><i class="fas fa-trash"></i> - Use 10</button>
                </div>
            </div>
        }
    </div>
</div>
